<!doctype html>
<html lang="pt">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Pr√©-visualiza√ß√£o 1.1 ‚Äî Entre Mundos (todas as abas)</title>
<style>
  :root{
    --bg:#0b2238; --card:#112c4a; --card-edge:#1a3a5a;
    --text:#e8f0fb; --muted:#a9bed9; --accent:#ffd85b;
    --btn:#214f85; --btn-soft:#173a63; --btn-text:#fff;
    --radius:20px; --shadow:0 10px 24px rgba(0,0,0,.35);
  }
  html,body{margin:0;background:#0b2238;color:var(--text);
    font-family:-apple-system,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;line-height:1.5}
  .wrap{max-width:860px;margin:24px auto;padding:0 16px}
  header{display:flex;gap:12px;align-items:center;margin:8px 0 14px}
  .dot{width:26px;height:26px;border-radius:8px;background:radial-gradient(circle at 30% 30%, #3ea7ff, #0e4379 60%, #0a2a4a)}
  h1{margin:0 0 10px}
  nav{display:flex;gap:10px;flex-wrap:wrap;margin:0 0 14px}
  .chip{padding:10px 14px;border-radius:16px;background:rgba(255,255,255,.06);
    color:var(--muted);border:1px solid rgba(255,255,255,.07);cursor:pointer;user-select:none}
  .chip.active{background:rgba(255,255,255,.12);color:#fff}
  .card{background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
    border:1px solid var(--card-edge);border-radius:var(--radius);box-shadow:var(--shadow);
    padding:18px;margin:16px 0}
  .card h2{margin:0 0 10px;font-size:18px;color:var(--muted);font-weight:600}
  #oracleMsg{font-size:22px;margin:12px 0 16px}
  .row{display:flex;gap:10px;flex-wrap:wrap}
  button{appearance:none;border:0;border-radius:14px;padding:12px 16px;
    background:var(--btn);color:var(--btn-text);font-weight:700;cursor:pointer}
  button.secondary{background:var(--btn-soft)}
  button[disabled]{opacity:.6;cursor:not-allowed}
  .note{color:var(--muted);font-size:14px;margin-top:8px}
  .fav-empty{color:var(--muted);font-style:italic}
  .fav-item{display:flex;justify-content:space-between;gap:12px;padding:10px 0;
    border-bottom:1px solid rgba(255,255,255,.08)}
  .fav-text{flex:1}
  .muted-link{color:var(--muted);text-decoration:underline;cursor:pointer}
  footer{color:var(--muted);text-align:center;margin:22px 0}
</style>
</head>
<body>
<div class="wrap">
  <header>
    <div class="dot" aria-hidden="true"></div>
    <h1>Entre Mundos ‚Äî Pr√©-visualiza√ß√£o 1.1</h1>
  </header>

  <nav aria-label="Sec√ß√µes">
    <div class="chip active" data-tab="tabMensagem" role="button" tabindex="0">Mensagem</div>
    <div class="chip" data-tab="tabRespiracao" role="button" tabindex="0">Respira√ß√£o</div>
    <div class="chip" data-tab="tabFrase" role="button" tabindex="0">Frase</div>
    <div class="chip" data-tab="tabSilencio" role="button" tabindex="0">Sil√™ncio</div>
    <div class="chip" data-tab="tabFavoritos" role="button" tabindex="0">Favoritos</div>
  </nav>

  <!-- Mensagem -->
  <section class="card" id="tabMensagem">
    <h2>Mensagem de hoje ‚Äî <span style="color:var(--accent);font-weight:700">Reconex√£o</span></h2>
    <p>Respira e lembra-te: <strong>tu √©s a casa antes do mundo.</strong> O teu valor n√£o depende da produtividade; a tua verdade n√£o precisa gritar. A cor azul √© o teu porto ‚Äî volta a ela quando o ru√≠do te cansar.</p>
  </section>

  <!-- Respira√ß√£o (preview) -->
  <section class="card" id="tabRespiracao" style="display:none">
    <h2>Exerc√≠cio de Respira√ß√£o</h2>
    <p>Inspira 4, segura 4, expira 6. Repete 5 vezes.</p>
    <div class="note">Na 1.1 v√£o entrar modos: Box (4-4-4-4), Alongada (4-4-6) e 4-7-8.</div>
  </section>

  <!-- Frase -->
  <section class="card" id="tabFrase" style="display:none">
    <h2>Frase Inspiradora</h2>
    <p>"Mesmo no escuro, a tua luz interior sabe o caminho."</p>
  </section>

  <!-- Sil√™ncio -->
  <section class="card" id="tabSilencio" style="display:none">
    <h2>Pr√°tica de Sil√™ncio</h2>
    <p>Fecha os olhos, escuta o som da tua respira√ß√£o e deixa que o mundo desapare√ßa por 1 minuto.</p>
  </section>

  <!-- Favoritos -->
  <section class="card" id="tabFavoritos" style="display:none">
    <h2>Favoritos</h2>
    <div id="favList" aria-live="polite"></div>
    <div class="note"><span class="muted-link" id="btnClearAll" role="button" tabindex="0">Limpar todos</span></div>
  </section>

  <!-- Or√°culo (vis√≠vel em todas as abas, exceto Sil√™ncio) -->
  <section class="card" id="cardOraculo">
    <h2>Or√°culo ‚Äî Entre Mundos</h2>
    <div id="oracleMsg" aria-live="polite">Toca em <em>‚ÄúNova mensagem‚Äù</em> para receber a tua mensagem.</div>
    <div class="row">
      <button id="btnNova">Nova mensagem</button>
      <button class="secondary" id="btnCopiar">Copiar</button>
      <button class="secondary" id="btnWhats">Partilhar no WhatsApp</button>
      <button id="btnFav" title="Guardar esta frase nos favoritos">‚≠ê Guardar</button>
    </div>
    <div class="note">As frases surgem de forma aleat√≥ria e sem n√∫meros.</div>
  </section>

  <footer>Pr√©-visualiza√ß√£o ‚Äî n√£o altera a vers√£o principal üíô</footer>
</div>

<script>
/* ===== Tabs ===== */
function activateTab(id){
  document.querySelectorAll('.chip').forEach(c=>c.classList.remove('active'));
  document.querySelector(`.chip[data-tab="${id}"]`)?.classList.add('active');
  document.querySelectorAll('section.card:not(#cardOraculo)').forEach(sec=>sec.style.display='none');
  document.getElementById(id).style.display='block';

  // Respeita o sil√™ncio: esconde o Or√°culo nessa aba
  document.getElementById('cardOraculo').style.display = (id==='tabSilencio') ? 'none' : 'block';

  if(id==='tabFavoritos') renderFavs();
}
document.querySelectorAll('.chip[data-tab]').forEach(chip=>{
  chip.addEventListener('click', ()=> activateTab(chip.dataset.tab));
  chip.addEventListener('keydown', (e)=>{ if(e.key==='Enter'||e.key===' '){ e.preventDefault(); activateTab(chip.dataset.tab); }});
});

/* ===== Or√°culo (amostra s√≥ para preview) =====
   Na app real, o baralho vem de oraculo.js (509). */
const SAMPLE = [
  "Volta a ti. Deixa que a ternura conduz como quem confia.",
  "Aquece o cora√ß√£o; a vergonha solta-se com verdade.",
  "Respirar √© regressar.",
  "A paz n√£o √© meta; √© caminho.",
  "O azul lembra-te: est√°s a salvo.",
  "S√™ presen√ßa; o medo diminui com amor manso.",
  "O essencial n√£o grita.",
  "A tua presen√ßa muda a sala.",
  "Deixar ir abre espa√ßo para chegar.",
  "A intui√ß√£o fala baixo ‚Äî aproxima-te.",
  "Aceitar n√£o te diminui, liberta-te.",
  "Podes come√ßar pequeno e ainda assim come√ßar."
];
let deck = shuffle([...SAMPLE]);
let idx = 0, last = "";
const elText   = document.getElementById('oracleMsg');
const btnNova  = document.getElementById('btnNova');
const btnCopiar= document.getElementById('btnCopiar');
const btnWhats = document.getElementById('btnWhats');
const btnFav   = document.getElementById('btnFav');

function shuffle(a){ for(let i=a.length-1;i>0;i--){ const j=(Math.random()*(i+1))|0; [a[i],a[j]]=[a[j],a[i]];} return a; }
function novaFrase(){
  if(idx>=deck.length){ deck=shuffle(deck); idx=0; }
  let f=deck[idx++]; if(f===last && idx<deck.length) f=deck[idx++];
  last=f; elText.textContent=f; updateFavButtonState();
}
function copiar(){
  const t=(elText.textContent||'').trim(); if(!t) return;
  if(navigator.clipboard?.writeText) navigator.clipboard.writeText(t).catch(()=>{});
}
function whats(){
  const t=encodeURIComponent((elText.textContent||'').trim()); if(!t) return;
  location.href='https://wa.me/?text='+t;
}
btnNova.addEventListener('click', novaFrase);
btnCopiar.addEventListener('click', copiar);
btnWhats.addEventListener('click', whats);

/* ===== Favoritos (localStorage) ===== */
const LS_KEY='entreMundos.favs.v1';
function getFavs(){ try{ return JSON.parse(localStorage.getItem(LS_KEY)||'[]'); }catch{ return []; } }
function setFavs(arr){ localStorage.setItem(LS_KEY, JSON.stringify(arr.slice(0,1000))); }
function isFav(txt){ const t=(txt||'').trim(); return getFavs().some(x=>x===t); }
function addFav(){
  const t=(elText.textContent||'').trim(); if(!t) return;
  const favs=getFavs(); if(!favs.includes(t)){ favs.unshift(t); setFavs(favs); }
  updateFavButtonState();
}
function removeFav(txt){ const favs=getFavs().filter(x=>x!==txt); setFavs(favs); renderFavs(); updateFavButtonState(); }
function clearAll(){ if(confirm('Limpar todos os favoritos?')){ setFavs([]); renderFavs(); updateFavButtonState(); } }
function escapeHtml(s){ return s.replace(/[&<>"]/g, m=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'}[m])); }
function renderFavs(){
  const box=document.getElementById('favList'); const favs=getFavs();
  if(!favs.length){ box.innerHTML='<p class="fav-empty">Ainda n√£o tens favoritos. Guarda frases com o bot√£o ‚≠ê no Or√°culo.</p>'; return; }
  box.innerHTML=favs.map(t=>`
    <div class="fav-item">
      <div class="fav-text">${escapeHtml(t)}</div>
      <button class="secondary" data-rm="${encodeURIComponent(t)}">Remover</button>
    </div>`).join('');
  box.querySelectorAll('button[data-rm]').forEach(b=> b.addEventListener('click',()=> removeFav(decodeURIComponent(b.dataset.rm))));
}
function updateFavButtonState(){
  const t=(elText.textContent||'').trim();
  if(!t){ btnFav.disabled=true; btnFav.textContent='‚≠ê Guardar'; return; }
  btnFav.disabled=false; btnFav.textContent = isFav(t) ? '‚òÖ Guardado' : '‚≠ê Guardar';
}
btnFav.addEventListener('click', ()=>{ const t=(elText.textContent||'').trim(); if(!t||isFav(t)) return; addFav(); });
document.getElementById('btnClearAll').addEventListener('click', clearAll);
document.getElementById('btnClearAll').addEventListener('keydown', e=>{ if(e.key==='Enter'||e.key===' '){ e.preventDefault(); clearAll(); }});

/* start */
elText.textContent='Toca em ‚ÄúNova mensagem‚Äù para receber a tua mensagem.';
updateFavButtonState();
</script>
</body>
</html>
